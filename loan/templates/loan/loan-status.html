{% extends 'core/base.html' %} {% block content %}

<div class="container py-4">
  <div class="card animate__animated animate__fadeIn shadow border-0">
    <!-- Card Header -->
    <div class="card-header bg-primary bg-gradient text-white">
      <div class="d-flex justify-content-between align-items-center">
        <h3 class="mb-0">
          <i class="fas fa-file-invoice-dollar me-2"></i>
          My Loan Applications
        </h3>
        <a href="{% url 'loan:loan-list' %}" class="btn btn-light btn-sm">
          <i class="fas fa-plus me-1"></i> New Application
        </a>
      </div>
    </div>

    <!-- Card Body -->
    <div class="card-body">
      {% if applications %}
      <div class="table-responsive">
        <table class="table table-hover align-middle">
          <thead class="table-light">
            <tr>
              <th scope="col" class="text-center">#</th>
              <th scope="col">Loan Type</th>
              <th scope="col" class="text-end">Amount</th>
              <th scope="col" class="text-center">Status</th>
              <th scope="col" class="text-center">Applied On</th>
            </tr>
          </thead>
          <tbody>
            {% for app in applications %}
            <tr
              class="animate__animated animate__fadeInUp"
              style="animation-delay: {{ forloop.counter0|divisibleby:2|yesno:'0.1s,0.2s' }}"
            >
              <th scope="row" class="text-center">{{ forloop.counter }}</th>
              <td>
                <strong>{{ app.loan.loan_type }}</strong>
                <small class="d-block text-muted"
                  >Ref: #{{ app.id|stringformat:"04d" }}</small
                >
              </td>
              <td class="text-end fw-bold">${{ app.amount }}</td>
              <td class="text-center">
                <span
                  class="badge rounded-pill py-2 {% if app.status == app.status.LoanStatus.PENDING %}bg-info text-dark{% elif app.status == app.status.LoanStatus.APPROVED %}bg-success{% else %}bg-danger{% endif %}"
                >
                  {{ app.get_status_display }}
                </span>
              </td>
              <td class="text-center">{{ app.applied_date|date:"M d, Y" }}</td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
      {% else %}
      <!-- Empty State -->
      <div class="text-center py-5">
        <i class="fas fa-file-alt fa-4x text-muted mb-4"></i>
        <h5 class="text-muted">No Loan Applications Found</h5>
        <p class="text-muted mb-4">
          You haven't submitted any loan applications yet.
        </p>
        <a href="{% url 'loan:loan-list' %}" class="btn btn-primary px-4">
          <i class="fas fa-paper-plane me-2"></i>Apply Now
        </a>
      </div>
      {% endif %}
    </div>

    <!-- Card Footer -->
    {% if applications %}
    <div class="card-footer bg-light">
      <small class="text-muted">
        Showing {{ applications|length }} application{{ applications|length|pluralize }}
      </small>
    </div>
    {% endif %}
  </div>
</div>

{% endblock content %}
